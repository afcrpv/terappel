.nested-fields
  .row
    .col-sm-2
      .form-group
        = f.label :age, class: 'control-label'
        .input-group
          = f.number_field :age, class: 'form-control'
          %span.input-group-addon semaines
  .row
    .col-sm-2
      = f.input :sexe, collection: Bebe::SEXE
    .col-sm-2
      .form-group
        = f.label :poids, class: 'control-label'
        .input-group
          = f.number_field :poids, class: 'form-control'
          %span.input-group-addon g
    .col-sm-2
      .form-group
        = f.label :taille, class: 'control-label'
        .input-group
          = f.number_field :taille, class: 'form-control'
          %span.input-group-addon cm
    .col-sm-2
      .form-group
        = f.label :pc, class: 'control-label'
        .input-group
          = f.number_field :pc, class: 'form-control'
          %span.input-group-addon cm
    - %w(1 5).each do |n|
      .col-sm-2
        = f.input :"apgar#{n}"
  .row
    - %w(malformation pathology).each do |field|
      - token_field = "#{field}_tokens"
      .col-sm-6
        .row
          .col-sm-4
            = f.input field.to_sym, collection: Dossier::ONI
          .col-sm-6
            = f.input token_field,
              placeholder: "Choisir les #{field.pluralize}" do
              = f.hidden_field token_field,
                class: token_field,
                value: (items = f.object.send(field.pluralize)).map(&:id).join(","),
                data: { load: (items.map(&:libelle_and_id).to_json),
                  "initial-ancestors": field.classify.constantize.find(items.map(&:id)).map(&:ancestor_ids).flatten.uniq }
          .col-sm-2
            .bebe-actions
              = link_to fa_icon('list'), "##{field}",
                class: "btn btn-default show_#{field}_tree",
                title: "Arbre #{field.capitalize.pluralize}",
                'data-toggle': 'modal'

  .field_links
    = link_to "#", class: 'btn btn-default btn-sm validate_bebe' do
      = fa_icon 'chevron-up'
      Valider Nouveau-n√©
    = link_to_remove_association 'remove bebe', f, class: 'sr-only'
